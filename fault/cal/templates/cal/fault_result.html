{% extends './base.html'%}
{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'cal/css/result.css'%}">
{% endblock css %}

{% block content %}
{% if faultcon.fault_type == 0 %}
<div class="main">
  <input type="radio" id="tab-1" name="show" checked/>
  <input type="radio" id="tab-2" name="show" />
  <input type="radio" id="tab-3" name="show" />
  <input type="radio" id="tab-4" name="show" />
  <input type="radio" id="tab-5" name="show" />
  <input type="radio" id="tab-6" name="show" />
  <input type="radio" id="tab-7" name="show" />
  <input type="radio" id="tab-8" name="show" />
  <div class="tab zero">
    <label for="tab-1">Initial Voltage Data</label>
    <label for="tab-2">Equipment Data</label>
    <label for="tab-3">Input Voltage Data</label>
    <label for="tab-4">Impedence Data</label>
    <label for="tab-5">Ybus</label>
    <label for="tab-6">Zbus</label>
    <label for="tab-7">Fault Voltage</label>
    <label for="tab-8">Fault Current</label>
  </div>
  <div class="content">
    <div class="content-dis">
      <div class="border">
        <div class="container  fault">
          <table class="table table-striped">
            {% if condition.is_flow %}
              <thead>
                <tr>
                  <td>Bus No</td>
                  <td>Magnitude</td>
                  <td>Angle(Deg)</td>
                  <td>Generator MW</td>
                  <td>Generator Mvar</td>
                  <td>Load MW</td>
                  <td>Load Mvar</td>
                  <td>Qmax</td>
                  <td>Qmin</td>
                  <td>Bus Code</td>
                </tr>
              </thead>
              <tbody>
                {% for i in busdata %}
                <tr>
                  <td>{{i.bus_num}}</td>
                  <td>{{i.Voltage_Mag|floatformat:-4}}</td>
                  <td>{{i.Voltage_Deg|floatformat:-4}}</td>
                  <td>{{i.Generator_MW|floatformat:-4}}</td>
                  <td>{{i.Generator_Mvar|floatformat:-4}}</td>
                  <td>{{i.Load_MW|floatformat:-4}}</td>
                  <td>{{i.Load_Mvar|floatformat:-4}}</td>
                  <td>{{i.Qmax|floatformat:-4}}</td>
                  <td>{{i.Qmin|floatformat:-4}}</td>
                  <td>{{i.Bus_Code}}</td>
                </tr>
                {% endfor %}
              </tbody>
            {% else %}
              <thead>
                <tr>
                  <td>Bus No</td>
                  <td>Magnitude</td>
                  <td>Angle(Deg)</td>
                </tr>
              </thead>
              <tbody>
                {% for i in busdata %}
                <tr>
                  <td>{{i.bus_num}}</td>
                  <td>{{i.Voltage_Mag|floatformat:-4}}</td>
                  <td>{{i.Voltage_Deg|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            {% endif %}
          </table>
        </div>
        <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
      </div>
    </div>
    <div class="content-dis">
      <div class="border">
        <div class="container  fault">
          <table class="table table-striped">
            {% if condition.is_not_symmetry %}
              <thead>
                <tr>
                  <td>Line Type</td>
                  <td>From Bus</td>
                  <td>To Bus</td>
                  <td>R+(pu)</td>
                  <td>X+(pu)</td>
                  <td>B+(pu)</td>
                  <td>R-(pu)</td>
                  <td>X-(pu)</td>
                  <td>R<sub>0</sub>(pu)</td>
                  <td>X<sub>0</sub>(pu)</td>
                  <td>Xn(pu)</td>
                  <td>B<sub>0</sub>(pu)</td>
                </tr>
              </thead>
              <tbody>
                {% for i in linedata %}
                <tr>
                {% if i.line_type == 0 %}
                    <td>G</td>
                  {% else %}
                    {% if i.line_type == 1 %}
                      <td>T/L</td>
                    {% else %}
                      {% if i.line_type == 2 %}
                        <td>T(1)</td>
                      {% else %}
                        {% if i.line_type == 3%}
                          <td>T(2)</td>
                        {% else %}
                          {% if i.line_type == 4%}
                            <td>T(3)</td>
                          {% else %}
                            {% if i.line_type == 5%}
                              <td>T(4)</td>
                            {% else %}
                              {% if i.line_type == 6%}
                                <td>T(5)</td>
                              {% else %}
                                <td>T(6)</td>
                              {% endif %}
                            {% endif %}
                          {% endif %}
                        {% endif %}
                      {% endif %}
                    {% endif %}
                  {% endif %}
                  <td>{{i.from_bus}}</td>
                  <td>{{i.to_bus}}</td>
                  <td>{{i.R|floatformat:-4}}</td>
                  <td>{{i.X|floatformat:-4}}</td>
                  <td>{{i.B|floatformat:-4}}</td>
                  <td>{{i.negative_R|floatformat:-4}}</td>
                  <td>{{i.negative_X|floatformat:-4}}</td>
                  <td>{{i.zero_R|floatformat:-4}}</td>
                  <td>{{i.zero_X|floatformat:-4}}</td>
                  <td>{{i.Xn|floatformat:-4}}</td>
                  <td>{{i.zero_B|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            {% else %}
              <thead>
                <tr>
                  <td>Line Type</td>
                  <td>From Bus</td>
                  <td>To Bus</td>
                  <td>R(pu)</td>
                  <td>X(pu)</td>
                  <td>B(pu)</td>
                </tr>
              </thead>
              <tbody>
                {% for i in linedata %}
                <tr>
                  {% if i.line_type == 0 %}
                    <td>G</td>
                  {% else %}
                    {% if i.line_type == 1 %}
                      <td>T/L</td>
                    {% else %}
                      {% if i.line_type == 2 %}
                        <td>T(1)</td>
                      {% else %}
                        {% if i.line_type == 3%}
                          <td>T(2)</td>
                        {% else %}
                          {% if i.line_type == 4%}
                            <td>T(3)</td>
                          {% else %}
                            {% if i.line_type == 5%}
                              <td>T(4)</td>
                            {% else %}
                              {% if i.line_type == 6%}
                                <td>T(5)</td>
                              {% else %}
                                <td>T(6)</td>
                              {% endif %}
                            {% endif %}
                          {% endif %}
                        {% endif %}
                      {% endif %}
                    {% endif %}
                  {% endif %}
                  <td>{{i.from_bus}}</td>
                  <td>{{i.to_bus}}</td>
                  <td>{{i.R|floatformat:-4}}</td>
                  <td>{{i.X|floatformat:-4}}</td>
                  <td>{{i.B|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            {% endif %}
          </table>
        </div>
        <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
      </div>
    </div>
    <div class="content-dis">
      <div class="border">
        <div class="container fault">
          <table class="table table-striped">
            {% if condition.is_flow %}
              <thead>
                <tr>
                  <td>Bus No</td>
                  <td>Magnitude</td>
                  <td>Angle(Deg)</td>
                  <td>Generator MW</td>
                  <td>Generator Mvar</td>
                  <td>Load MW</td>
                  <td>Load Mvar</td>
                </tr>
              </thead>
              <tbody>
                {% for busdata in faultbusdata %}
                <tr>
                  <td>{{busdata.Bus_No}}</td>
                  <td>{{busdata.Voltage_Mag|floatformat:-4}}</td>
                  <td>{{busdata.Voltage_Deg|floatformat:-4}}</td>
                  <td>{{busdata.Generator_MW|floatformat:-4}}</td>
                  <td>{{busdata.Generator_Mvar|floatformat:-4}}</td>
                  <td>{{busdata.Load_MW|floatformat:-4}}</td>
                  <td>{{busdata.Load_Mvar|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            {% else %}
            <thead>
              <tr>
                <td>Bus No</td>
                <td>Magnitude</td>
                <td>Angle(Deg)</td>
              </tr>
            </thead>
            <tbody>
              {% for busdata in faultbusdata %}
              <tr>
                <td>{{busdata.Bus_No}}</td>
                <td>{{busdata.Voltage_Mag|floatformat:-4}}</td>
                <td>{{busdata.Voltage_Deg|floatformat:-4}}</td>
              </tr>
              {% endfor %}
            </tbody>
            {% endif %}
          </table>
        </div>
        <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
      </div>
    </div>
    <div class="content-dis">
      <div class="border">
        <div class="container  fault">
          <table class="table table-striped">
            {% if condition.is_not_symmetry %}
              <thead>
                <tr>
                  <td>Line Type</td>
                  <td>From Bus</td>
                  <td>To Bus</td>
                  <td>R+(pu)</td>
                  <td>X+(pu)</td>
                  <td>B+(pu)</td>
                  <td>R-(pu)</td>
                  <td>X-(pu)</td>
                  <td>R<sub>0</sub>(pu)</td>
                  <td>X<sub>0</sub>(pu)</td>
                  <td>B<sub>0</sub>(pu)</td>
                </tr>
              </thead>
              <tbody>
                {% for i in faultlinedata %}
                <tr>
                  {% if i.line_type == 0 %}
                    <td>G</td>
                  {% else %}
                    {% if i.line_type == 1 %}
                      <td>T/L</td>
                    {% else %}
                      {% if i.line_type == 2 %}
                        <td>T(1)</td>
                      {% else %}
                        {% if i.line_type == 3%}
                          <td>T(2)</td>
                        {% else %}
                          {% if i.line_type == 4%}
                            <td>T(3)</td>
                          {% else %}
                            {% if i.line_type == 5%}
                              <td>T(4)</td>
                            {% else %}
                              {% if i.line_type == 6%}
                                <td>T(5)</td>
                              {% else %}
                                <td>T(6)</td>
                              {% endif %}
                            {% endif %}
                          {% endif %}
                        {% endif %}
                      {% endif %}
                    {% endif %}
                  {% endif %}
                  <td>{{i.From_Bus}}</td>
                  <td>{{i.To_Bus}}</td>
                  <td>{{i.R|floatformat:-4}}</td>
                  <td>{{i.X|floatformat:-4}}</td>
                  <td>{{i.B|floatformat:-4}}</td>
                  <td>{{i.negative_R|floatformat:-4}}</td>
                  <td>{{i.negative_X|floatformat:-4}}</td>
                  <td>{{i.zero_R|floatformat:-4}}</td>
                  <td>{{i.zero_X|floatformat:-4}}</td>
                  <td>{{i.zero_B|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            {% else %}
              <thead>
                <tr>
                  <td>Line Type</td>
                  <td>From Bus</td>
                  <td>To Bus</td>
                  <td>R(pu)</td>
                  <td>X(pu)</td>
                  <td>B(pu)</td>
                </tr>
              </thead>
              <tbody>
                {% for i in faultlinedata %}
                <tr>
                  {% if i.line_type == 0 %}
                    <td>G</td>
                  {% else %}
                    {% if i.line_type == 1 %}
                      <td>T/L</td>
                    {% else %}
                      {% if i.line_type == 2 %}
                        <td>T(1)</td>
                      {% else %}
                        {% if i.line_type == 3%}
                          <td>T(2)</td>
                        {% else %}
                          {% if i.line_type == 4%}
                            <td>T(3)</td>
                          {% else %}
                            {% if i.line_type == 5%}
                              <td>T(4)</td>
                            {% else %}
                              {% if i.line_type == 6%}
                                <td>T(5)</td>
                              {% else %}
                                <td>T(6)</td>
                              {% endif %}
                            {% endif %}
                          {% endif %}
                        {% endif %}
                      {% endif %}
                    {% endif %}
                  {% endif %}
                  <td>{{i.From_Bus}}</td>
                  <td>{{i.To_Bus}}</td>
                  <td>{{i.R|floatformat:-4}}</td>
                  <td>{{i.X|floatformat:-4}}</td>
                  <td>{{i.B|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            {% endif %}
          </table>
        </div>
        <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
      </div>
    </div>
    <div class="content-dis">
      <div class="border">
        <div class="container fault">
          <table class="table table-striped">
            <tbody>
              {% for i in threezbus %}
                <tr>
                {% for j in tsource %}
                  {% if i.check == j.row.check %}
                    {% if j.y_real_source == 0 %}
                      {% if j.y_imag_source == 0 %}
                        <td>0</td>
                      {% else %}
                        <td>{{j.y_imag_source|floatformat:-4}}j</td>
                      {% endif %}
                    {% else %}
                      {% if j.y_imag_source > 0 %}
                        <td>{{j.y_real_source|floatformat:-4}}+{{j.y_imag_source|floatformat:-4}}j</td>
                      {% else %}
                      <td>{{j.y_real_source|floatformat:-4}}{{j.y_imag_source|floatformat:-4}}j</td>
                      {%endif%}
                    {% endif %}
                  {% endif %}
                {% endfor %}
                </tr>
              {% endfor %} 
            </tbody>
          </table>
        </div>
        <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
      </div>
    </div>
    <div class="content-dis">
      <div class="border">
        <div class="container fault">
          <table class="table table-striped">
            <tbody>
              {% for i in threezbus %}
                <tr>
                {% for j in tsource %}
                  {% if i.check == j.row.check %}
                    {% if j.real_source == 0 %}
                      {% if j.imag_source == 0 %}
                        <td>0</td>
                      {% else %}
                        <td>{{j.imag_source|floatformat:-4}}j</td>
                      {% endif %}
                    {% else %}
                      {% if j.imag_source > 0 %}
                        <td>{{j.real_source|floatformat:-4}}+{{j.imag_source|floatformat:-4}}j</td>
                      {% else %}
                      <td>{{j.real_source|floatformat:-4}}{{j.imag_source|floatformat:-4}}j</td>
                      {%endif%}
                    {% endif %}
                  {% endif %}
                {% endfor %}
                </tr>
              {% endfor %} 
            </tbody>
          </table>
        </div>
        <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
      </div>
    </div>
    <div class="content-dis">
      <div class="border">
        <div class="container  fault">
          <table class="table table-striped">
            <thead>
              <tr>
                <td>Bus No</td>
                <td>Magnitude</td>
                <td>Angle(Deg)</td>
              </tr>
            </thead>
            <tbody>
              {% for threefaultv in threefaultv %}
              <tr>
                <td>{{threefaultv.Bus_No}}</td>
                <td>{{threefaultv.Voltage_Mag|floatformat:-4}}</td>
                <td>{{threefaultv.Voltage_Deg|floatformat:-4}}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
      </div>
    </div>
    <div class="content-dis">
      <div class="border">
        <div class="container  fault">
            <table class="table table-striped">
              <thead>
                <tr>
                  <td>Line Type</td>
                  <td>From Bus</td>
                  <td>To Bus</td>
                  <td>Magnitude</td>
                  <td>Angle(Deg)</td>
                </tr>
              </thead>
              <tbody>
                {% for i in threefaulti %}
                <tr>
                  {% if i.line_type == 0 %}
                    <td>G</td>
                  {% else %}
                    {% if i.line_type == 1 %}
                      <td>T/L</td>
                    {% else %}
                      {% if i.line_type == 2 %}
                        <td>T(1)</td>
                      {% else %}
                        {% if i.line_type == 3%}
                          <td>T(2)</td>
                        {% else %}
                          {% if i.line_type == 4%}
                            <td>T(3)</td>
                          {% else %}
                            {% if i.line_type == 5%}
                              <td>T(4)</td>
                            {% else %}
                              {% if i.line_type == 6%}
                                <td>T(5)</td>
                              {% else %}
                                {% if i.line_type == 8%}
                                  <td>Fault</td>
                                {% else %}
                                  <td>T(6)</td>
                                {% endif %}
                              {% endif %}
                            {% endif %}
                          {% endif %}
                        {% endif %}
                      {% endif %}
                    {% endif %}
                  {% endif %}
                  <td>{{i.From_Bus}}</td>
                  {% if i.To_Bus == -1 %}
                    <td>F</td>
                  {% else%}
                    <td>{{i.To_Bus}}</td>
                  {% endif%}
                  <td>{{i.Current_Mag|floatformat:-4}}</td>
                  <td>{{i.Current_Deg|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
      </div>
    </div>
  </div>
</div>
{% else %}
<div class="main">
  <input type="radio" id="tab-1" name="show" checked/>
    <input type="radio" id="tab-2" name="show" />
    <input type="radio" id="tab-3" name="show" />
    <input type="radio" id="tab-4" name="show" />
    <input type="radio" id="tab-5" name="show" />
    <input type="radio" id="tab-6" name="show" />
    <input type="radio" id="tab-7" name="show" />
    <input type="radio" id="tab-8" name="show" />
    <input type="radio" id="tab-9" name="show" />
    <input type="radio" id="tab-10" name="show" />
    <input type="radio" id="tab-11" name="show" />
    <input type="radio" id="tab-12" name="show" />
    <input type="radio" id="tab-13" name="show" />
    <input type="radio" id="tab-14" name="show" />
    <div class="tab other">
      <label for="tab-1">Initial Voltage Data</label>
      <label for="tab-2">Equipment Data</label>
      <label for="tab-3">Input Voltage Data</label>
      <label for="tab-4">Impedence Data</label>
      <label for="tab-5">Positive Ybus</label>
      <label for="tab-6">Negative Ybus</label>
      <label for="tab-7">Zero Ybus</label>
      <label for="tab-8">Positive Zbus</label>
      <label for="tab-9">Negative Zbus</label>
      <label for="tab-10">Zero Zbus</label>
      <label for="tab-11">Fault Sequence Voltage</label>
      <label for="tab-12">Fault Sequence Current</label>
      <label for="tab-13">Fault Phase Voltage</label>
      <label for="tab-14">Fault Phase Current</label>
    </div>
    <div class="content">
      <div class="content-dis">
        <div class="border">
          <div class="container  fault">
            <table class="table table-striped">
              {% if condition.is_flow %}
                <thead>
                  <tr>
                    <td>Bus No</td>
                    <td>Magnitude</td>
                    <td>Angle(Deg)</td>
                    <td>Generator MW</td>
                    <td>Generator Mvar</td>
                    <td>Load MW</td>
                    <td>Load Mvar</td>
                    <td>Qmax</td>
                    <td>Qmin</td>
                    <td>Bus Code</td>
                  </tr>
                </thead>
                <tbody>
                  {% for i in busdata %}
                  <tr>
                    <td>{{i.bus_num}}</td>
                    <td>{{i.Voltage_Mag|floatformat:-4}}</td>
                    <td>{{i.Voltage_Deg|floatformat:-4}}</td>
                    <td>{{i.Generator_MW|floatformat:-4}}</td>
                    <td>{{i.Generator_Mvar|floatformat:-4}}</td>
                    <td>{{i.Load_MW|floatformat:-4}}</td>
                    <td>{{i.Load_Mvar|floatformat:-4}}</td>
                    <td>{{i.Qmax|floatformat:-4}}</td>
                    <td>{{i.Qmin|floatformat:-4}}</td>
                    <td>{{i.Bus_Code}}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              {% else %}
                <thead>
                  <tr>
                    <td>Bus No</td>
                    <td>Magnitude</td>
                    <td>Angle(Deg)</td>
                  </tr>
                </thead>
                <tbody>
                  {% for i in busdata %}
                  <tr>
                    <td>{{i.bus_num}}</td>
                    <td>{{i.Voltage_Mag|floatformat:-4}}</td>
                    <td>{{i.Voltage_Deg|floatformat:-4}}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              {% endif %}
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container  fault">
            <table class="table table-striped">
              <thead>
                <tr>
                  <td>Line Type</td>
                  <td>From Bus</td>
                  <td>To Bus</td>
                  <td>R+(pu)</td>
                  <td>X+(pu)</td>
                  <td>B+(pu)</td>
                  <td>R-(pu)</td>
                  <td>X-(pu)</td>
                  <td>R<sub>0</sub>(pu)</td>
                  <td>X<sub>0</sub>(pu)</td>
                  <td>Xn(pu)</td>
                  <td>B<sub>0</sub>(pu)</td>
                </tr>
              </thead>
              <tbody>
                {% for i in linedata %}
                <tr>
                  {% if i.line_type == 0 %}
                    <td>G</td>
                  {% else %}
                    {% if i.line_type == 1 %}
                      <td>T/L</td>
                    {% else %}
                      {% if i.line_type == 2 %}
                        <td>T(1)</td>
                      {% else %}
                        {% if i.line_type == 3%}
                          <td>T(2)</td>
                        {% else %}
                          {% if i.line_type == 4%}
                            <td>T(3)</td>
                          {% else %}
                            {% if i.line_type == 5%}
                              <td>T(4)</td>
                            {% else %}
                              {% if i.line_type == 6%}
                                <td>T(5)</td>
                              {% else %}
                                <td>T(6)</td>
                              {% endif %}
                            {% endif %}
                          {% endif %}
                        {% endif %}
                      {% endif %}
                    {% endif %}
                  {% endif %}
                  <td>{{i.from_bus}}</td>
                  <td>{{i.to_bus}}</td>
                  <td>{{i.R|floatformat:-4}}</td>
                  <td>{{i.X|floatformat:-4}}</td>
                  <td>{{i.B|floatformat:-4}}</td>
                  <td>{{i.negative_R|floatformat:-4}}</td>
                  <td>{{i.negative_X|floatformat:-4}}</td>
                  <td>{{i.zero_R|floatformat:-4}}</td>
                  <td>{{i.zero_X|floatformat:-4}}</td>
                  <td>{{i.Xn|floatformat:-4}}</td>
                  <td>{{i.zero_B|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container  fault">
            <table class="table table-striped">
              {% if condition.is_flow %}
                <thead>
                  <tr>
                    <td>Bus No</td>
                    <td>Magnitude</td>
                    <td>Angle(Deg)</td>
                    <td>Generator MW</td>
                    <td>Generator Mvar</td>
                    <td>Load MW</td>
                    <td>Load Mvar</td>
                    <td>Qmax</td>
                    <td>Qmin</td>
                    <td>Bus Code</td>
                  </tr>
                </thead>
                <tbody>
                  {% for i in busdata %}
                  <tr>
                    <td>{{i.bus_num}}</td>
                    <td>{{i.Voltage_Mag|floatformat:-4}}</td>
                    <td>{{i.Voltage_Deg|floatformat:-4}}</td>
                    <td>{{i.Generator_MW|floatformat:-4}}</td>
                    <td>{{i.Generator_Mvar|floatformat:-4}}</td>
                    <td>{{i.Load_MW|floatformat:-4}}</td>
                    <td>{{i.Load_Mvar|floatformat:-4}}</td>
                    <td>{{i.Qmax|floatformat:-4}}</td>
                    <td>{{i.Qmin|floatformat:-4}}</td>
                    <td>{{i.Bus_Code}}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              {% else %}
                <thead>
                  <tr>
                    <td>Bus No</td>
                    <td>Magnitude</td>
                    <td>Angle(Deg)</td>
                  </tr>
                </thead>
                <tbody>
                  {% for i in busdata %}
                  <tr>
                    <td>{{i.bus_num}}</td>
                    <td>{{i.Voltage_Mag|floatformat:-4}}</td>
                    <td>{{i.Voltage_Deg|floatformat:-4}}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              {% endif %}
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container  fault">
            <table class="table table-striped">
              <thead>
                <tr>
                  <td>Line Data</td>
                  <td>From Bus</td>
                  <td>To Bus</td>
                  <td>R+(pu)</td>
                  <td>X+(pu)</td>
                  <td>B+(pu)</td>
                  <td>R-(pu)</td>
                  <td>X-(pu)</td>
                  <td>R<sub>0</sub>(pu)</td>
                  <td>X<sub>0</sub>(pu)</td>
                  <td>B<sub>0</sub>(pu)</td>
                </tr>
              </thead>
              <tbody>
                {% for i in faultlinedata %}
                <tr>
                  {% if i.line_type == 0 %}
                    <td>G</td>
                  {% else %}
                    {% if i.line_type == 1 %}
                      <td>T/L</td>
                    {% else %}
                      {% if i.line_type == 2 %}
                        <td>T(1)</td>
                      {% else %}
                        {% if i.line_type == 3%}
                          <td>T(2)</td>
                        {% else %}
                          {% if i.line_type == 4%}
                            <td>T(3)</td>
                          {% else %}
                            {% if i.line_type == 5%}
                              <td>T(4)</td>
                            {% else %}
                              {% if i.line_type == 6%}
                                <td>T(5)</td>
                              {% else %}
                                <td>T(6)</td>
                              {% endif %}
                            {% endif %}
                          {% endif %}
                        {% endif %}
                      {% endif %}
                    {% endif %}
                  {% endif %}
                  <td>{{i.From_Bus}}</td>
                  <td>{{i.To_Bus}}</td>
                  <td>{{i.R|floatformat:-4}}</td>
                  <td>{{i.X|floatformat:-4}}</td>
                  <td>{{i.B|floatformat:-4}}</td>
                  <td>{{i.negative_R|floatformat:-4}}</td>
                  <td>{{i.negative_X|floatformat:-4}}</td>
                  <td>{{i.zero_R|floatformat:-4}}</td>
                  <td>{{i.zero_X|floatformat:-4}}</td>
                  <td>{{i.zero_B|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container fault">
            <table class="table table-striped">
              <tbody>
                {% for i in otherzbus %}
                  <tr>
                  {% for j in osource %}
                    {% if i.check == j.row.check %}
                      {% if j.real_source == 0 %}
                        {% if j.imag_source == 0 %}
                          <td>0</td>
                        {% else %}
                          <td>{{j.imag_source|floatformat:-4}}j</td>
                        {% endif %}
                      {% else %}
                      {% if j.imag_source > 0 %}
                        <td>{{j.real_source|floatformat:-4}}+{{j.imag_source|floatformat:-4}}j</td>
                      {% else %}
                      <td>{{j.real_source|floatformat:-4}}{{j.imag_source|floatformat:-4}}j</td>
                      {%endif%}
                      {% endif %}
                    {% endif %}
                  {% endfor %}
                  </tr>
                {% endfor %} 
              </tbody>
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container fault">
            <table class="table table-striped">
              <tbody>
                {% for i in otherzbus %}
                  <tr>
                  {% for j in nsource %}
                    {% if i.check == j.row.check %}
                      {% if j.y_real_source == 0 %}
                        {% if j.y_imag_source == 0 %}
                          <td>0</td>
                        {% else %}
                          <td>{{j.y_imag_source|floatformat:-4}}j</td>
                        {% endif %}
                      {% else %}
                      {% if j.y_imag_source > 0 %}
                        <td>{{j.y_real_source|floatformat:-4}}+{{j.y_imag_source|floatformat:-4}}j</td>
                      {% else %}
                      <td>{{j.y_real_source|floatformat:-4}}{{j.y_imag_source|floatformat:-4}}j</td>
                      {%endif%}
                      {% endif %}
                    {% endif %}
                  {% endfor %}
                  </tr>
                {% endfor %} 
              </tbody>
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container fault">
            <table class="table table-striped">
              <tbody>
                {% for i in otherzbus %}
                  <tr>
                  {% for j in zsource %}
                    {% if i.check == j.row.check %}
                      {% if j.y_real_source == 0 %}
                        {% if j.y_imag_source == 0 %}
                          <td>0</td>
                        {% else %}
                          <td>{{j.y_imag_source|floatformat:-4}}j</td>
                        {% endif %}
                      {% else %}
                      {% if j.y_imag_source > 0 %}
                        <td>{{j.y_real_source|floatformat:-4}}+{{j.y_imag_source|floatformat:-4}}j</td>
                      {% else %}
                      <td>{{j.y_real_source|floatformat:-4}}{{j.y_imag_source|floatformat:-4}}j</td>
                      {%endif%}
                      {% endif %}
                    {% endif %}
                  {% endfor %}
                  </tr>
                {% endfor %} 
              </tbody>
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container fault">
            <table class="table table-striped">
              <tbody>
                {% for i in otherzbus %}
                  <tr>
                  {% for j in osource %}
                    {% if i.check == j.row.check %}
                      {% if j.real_source == 0 %}
                        {% if j.imag_source == 0 %}
                          <td>0</td>
                        {% else %}
                          <td>{{j.imag_source|floatformat:-4}}j</td>
                        {% endif %}
                      {% else %}
                      {% if j.imag_source > 0 %}
                        <td>{{j.real_source|floatformat:-4}}+{{j.imag_source|floatformat:-4}}j</td>
                      {% else %}
                      <td>{{j.real_source|floatformat:-4}}{{j.imag_source|floatformat:-4}}j</td>
                      {%endif%}
                      {% endif %}
                    {% endif %}
                  {% endfor %}
                  </tr>
                {% endfor %} 
              </tbody>
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container fault">
            <table class="table table-striped">
              <tbody>
                {% for i in otherzbus %}
                  <tr>
                  {% for j in nsource %}
                    {% if i.check == j.row.check %}
                      {% if j.real_source == 0 %}
                        {% if j.imag_source == 0 %}
                          <td>0</td>
                        {% else %}
                          <td>{{j.imag_source|floatformat:-4}}j</td>
                        {% endif %}
                      {% else %}
                      {% if j.imag_source > 0 %}
                        <td>{{j.real_source|floatformat:-4}}+{{j.imag_source|floatformat:-4}}j</td>
                      {% else %}
                      <td>{{j.real_source|floatformat:-4}}{{j.imag_source|floatformat:-4}}j</td>
                      {%endif%}
                      {% endif %}
                    {% endif %}
                  {% endfor %}
                  </tr>
                {% endfor %} 
              </tbody>
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container fault">
            <table class="table table-striped">
              <tbody>
                {% for i in otherzbus %}
                  <tr>
                  {% for j in zsource %}
                    {% if i.check == j.row.check %}
                      {% if j.real_source == 0 %}
                        {% if j.imag_source == 0 %}
                          <td>0</td>
                        {% else %}
                          <td>{{j.imag_source|floatformat:-4}}j</td>
                        {% endif %}
                      {% else %}
                      {% if j.imag_source > 0 %}
                        <td>{{j.real_source|floatformat:-4}}+{{j.imag_source|floatformat:-4}}j</td>
                      {% else %}
                      <td>{{j.real_source|floatformat:-4}}{{j.imag_source|floatformat:-4}}j</td>
                      {%endif%}
                      {% endif %}
                    {% endif %}
                  {% endfor %}
                  </tr>
                {% endfor %} 
              </tbody>
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container  fault">
            <table class="table table-striped">
              <thead>
                <tr>
                  <td>Bus No</td>
                  <td>Zero Mag</td>
                  <td>Zero Deg</td>
                  <td>Positive Mag</td>
                  <td>Positive Deg</td>
                  <td>Negative Mag</td>
                  <td>Negatvie Deg</td>
                </tr>
              </thead>
              <tbody>
                {% for sequencev in sequencev %}
                <tr>
                  <td>{{sequencev.Bus_No}}</td>
                  <td>{{sequencev.Phase_A_Mag|floatformat:-4}}</td>
                  <td>{{sequencev.Phase_A_Deg|floatformat:-4}}</td>
                  <td>{{sequencev.Phase_B_Mag|floatformat:-4}}</td>
                  <td>{{sequencev.Phase_B_Deg|floatformat:-4}}</td>
                  <td>{{sequencev.Phase_C_Mag|floatformat:-4}}</td>
                  <td>{{sequencev.Phase_C_Deg|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container  fault">
            <table class="table table-striped">
              <thead>
                <tr>
                  <td>Line Type</td>
                  <td>From Bus</td>
                  <td>To Bus</td>
                  <td>Zero Mag</td>
                  <td>Zero Deg</td>
                  <td>Positive Mag</td>
                  <td>Positive Deg</td>
                  <td>Negative Mag</td>
                  <td>Negatvie Deg</td>
                </tr>
              </thead>
              <tbody>
                {% for i in sequencei %}
                <tr>
                  {% if i.line_type == 0 %}
                    <td>G</td>
                  {% else %}
                    {% if i.line_type == 1 %}
                      <td>T/L</td>
                    {% else %}
                      {% if i.line_type == 2 %}
                        <td>T(1)</td>
                      {% else %}
                        {% if i.line_type == 3%}
                          <td>T(2)</td>
                        {% else %}
                          {% if i.line_type == 4%}
                            <td>T(3)</td>
                          {% else %}
                            {% if i.line_type == 5%}
                              <td>T(4)</td>
                            {% else %}
                              {% if i.line_type == 6%}
                                <td>T(5)</td>
                              {% else %}
                                {% if i.line_type == 8%}
                                  <td>Fault</td>
                                {% else %}
                                  <td>T(6)</td>
                                {% endif %}
                              {% endif %}
                            {% endif %}
                          {% endif %}
                        {% endif %}
                      {% endif %}
                    {% endif %}
                  {% endif %}
                  <td>{{i.From_Bus}}</td>
                  {% if i.To_Bus == -1%}
                    <td>F</td>
                  {% else%}
                    <td>{{i.To_Bus}}</td>
                  {% endif%}
                  <td>{{i.Phase_A_Mag|floatformat:-4}}</td>
                  <td>{{i.Phase_A_Deg|floatformat:-4}}</td>
                  <td>{{i.Phase_B_Mag|floatformat:-4}}</td>
                  <td>{{i.Phase_B_Deg|floatformat:-4}}</td>
                  <td>{{i.Phase_C_Mag|floatformat:-4}}</td>
                  <td>{{i.Phase_C_Deg|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container  fault">
            <table class="table table-striped">
              <thead>
                <tr>
                  <td>Bus No</td>
                  <td>Phase A Mag</td>
                  <td>Phase A Deg</td>
                  <td>Phase B Mag</td>
                  <td>Phase B Deg</td>
                  <td>Phase C Mag</td>
                  <td>Phase C Deg</td>
                </tr>
              </thead>
              <tbody>
                {% for otherfaultv in otherfaultv %}
                <tr>
                  <td>{{otherfaultv.Bus_No}}</td>
                  <td>{{otherfaultv.Phase_A_Mag|floatformat:-4}}</td>
                  <td>{{otherfaultv.Phase_A_Deg|floatformat:-4}}</td>
                  <td>{{otherfaultv.Phase_B_Mag|floatformat:-4}}</td>
                  <td>{{otherfaultv.Phase_B_Deg|floatformat:-4}}</td>
                  <td>{{otherfaultv.Phase_C_Mag|floatformat:-4}}</td>
                  <td>{{otherfaultv.Phase_C_Deg|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
      <div class="content-dis">
        <div class="border">
          <div class="container  fault">
            <table class="table table-striped">
              <thead>
                <tr>
                  <td>Line Type</td>
                  <td>From Bus</td>
                  <td>To Bus</td>
                  <td>Phase A Mag</td>
                  <td>Phase A Deg</td>
                  <td>Phase B Mag</td>
                  <td>Phase B Deg</td>
                  <td>Phase C Mag</td>
                  <td>Phase C Deg</td>
                </tr>
              </thead>
              <tbody>
                {% for i in otherfaulti %}
                <tr>
                  {% if i.line_type == 0 %}
                    <td>G</td>
                  {% else %}
                    {% if i.line_type == 1 %}
                      <td>T/L</td>
                    {% else %}
                      {% if i.line_type == 2 %}
                        <td>T(1)</td>
                      {% else %}
                        {% if i.line_type == 3%}
                          <td>T(2)</td>
                        {% else %}
                          {% if i.line_type == 4%}
                            <td>T(3)</td>
                          {% else %}
                            {% if i.line_type == 5%}
                              <td>T(4)</td>
                            {% else %}
                              {% if i.line_type == 6%}
                                <td>T(5)</td>
                              {% else %}
                                {% if i.line_type == 8%}
                                  <td>Fault</td>
                                {% else %}
                                  <td>T(6)</td>
                                {% endif %}
                              {% endif %}
                            {% endif %}
                          {% endif %}
                        {% endif %}
                      {% endif %}
                    {% endif %}
                  {% endif %}
                  <td>{{i.From_Bus}}</td>
                  {% if i.To_Bus == -1%}
                    <td>F</td>
                  {% else%}
                    <td>{{i.To_Bus}}</td>
                  {% endif%}
                  <td>{{i.Phase_A_Mag|floatformat:-4}}</td>
                  <td>{{i.Phase_A_Deg|floatformat:-4}}</td>
                  <td>{{i.Phase_B_Mag|floatformat:-4}}</td>
                  <td>{{i.Phase_B_Deg|floatformat:-4}}</td>
                  <td>{{i.Phase_C_Mag|floatformat:-4}}</td>
                  <td>{{i.Phase_C_Deg|floatformat:-4}}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          <a href="{{ outfile.rfile.url}}" class="btn btn-outline-success next" role="button" download="fault_calculation_result.xlsx"><img class="excel-img-small" src="{% static 'cal/images/excel.png'%}"/> Download</a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endif %}
{% endblock content %}

